<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pharaoh Photo Converter</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Egyptian+Hieroglyphs&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --gold: #ffd700;
      --dark-gold: #daa520;
      --teal: #008080;
      --black: #1a1a1a;
    }
    
    body {
      font-family: 'Cairo', sans-serif;
      background: var(--black) url('https://images.unsplash.com/photo-1548438294-1ad5d5f4f063?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') no-repeat center/cover;
      color: white;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
      padding: 20px;
    }
    
    .card {
      background: rgba(0, 0, 0, 0.8);
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 20px #000;
    }
    
    input, button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: none;
      border-radius: 8px;
      font-size: 16px;
    }
    
    input {
      background: #f0f0f0;
      color: #333;
    }
    
    #cameraBtn {
      background: var(--gold);
      color: var(--black);
      font-weight: bold;
    }
    
    video, canvas {
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
      display: none;
    }
    
    .actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    .actions button {
      flex: 1;
    }
    
    #resultCanvas {
      border: 2px solid var(--gold);
    }
  </style>
</head>
<body>
  <div class="card">
    <h2><i class="fas fa-camera"></i> Pharaoh Photo Converter</h2>
    <input type="text" id="username" placeholder="Type your name in English">
    
    <button id="cameraBtn"><i class="fas fa-camera"></i> Open Camera</button>
    
    <video id="video" autoplay muted playsinline></video>
    <canvas id="resultCanvas"></canvas>
    
    <div class="actions" id="actionButtons" style="display:none;">
      <button id="captureBtn" style="background:var(--teal);color:white;"><i class="fas fa-camera-retro"></i> Capture</button>
      <button id="cancelBtn" style="background:#d9534f;color:white;"><i class="fas fa-times"></i> Cancel</button>
    </div>
    
    <div class="actions" id="downloadSection" style="display:none;">
      <button id="downloadBtn" style="background:var(--gold);color:var(--black);"><i class="fas fa-download"></i> Download</button>
      <button id="newPhotoBtn" style="background:var(--teal);color:white;"><i class="fas fa-redo"></i> Retake</button>
    </div>
  </div>

  <script>
    // Hieroglyphic Characters Map
    const hieroglyphMap = {
      'A': 'ð“„¿', 'B': 'ð“ƒ€', 'C': 'ð“¿', 'D': 'ð“‚§', 'E': 'ð“‡‹',
      'F': 'ð“†‘', 'G': 'ð“Ž¼', 'H': 'ð“Ž›', 'I': 'ð“‡‹', 'J': 'ð“†“',
      'K': 'ð“Ž¡', 'L': 'ð“ƒ­', 'M': 'ð“…“', 'N': 'ð“ˆ–', 'O': 'ð“…±',
      'P': 'ð“Šª', 'Q': 'ð“˜', 'R': 'ð“‚‹', 'S': 'ð“‹´', 'T': 'ð“',
      'U': 'ð“…±', 'V': 'ð“†‘', 'W': 'ð“…±', 'X': 'ð“', 'Y': 'ð“‡Œ', 'Z': 'ð“Šƒ',
      ' ': ' '
    };

    // DOM Elements
    const video = document.getElementById('video');
    const resultCanvas = document.getElementById('resultCanvas');
    let stream = null;

    // Camera Functions
    document.getElementById('cameraBtn').addEventListener('click', toggleCamera);
    document.getElementById('cancelBtn').addEventListener('click', toggleCamera);
    document.getElementById('newPhotoBtn').addEventListener('click', toggleCamera);

    async function toggleCamera() {
      if (stream) {
        // Turn off camera
        stream.getTracks().forEach(track => track.stop());
        stream = null;
        video.style.display = 'none';
        document.getElementById('actionButtons').style.display = 'none';
        document.getElementById('downloadSection').style.display = 'none';
        resultCanvas.style.display = 'none';
        document.getElementById('cameraBtn').innerHTML = '<i class="fas fa-camera"></i> Open Camera';
        return;
      }

      // Turn on camera
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
        video.style.display = 'block';
        document.getElementById('actionButtons').style.display = 'flex';
        document.getElementById('cameraBtn').innerHTML = '<i class="fas fa-camera-slash"></i> Close Camera';
      } catch (err) {
        alert("Camera error: " + err.message);
      }
    }

    // Capture Photo with Hieroglyphs
    document.getElementById('captureBtn').addEventListener('click', () => {
      if (!stream) return;
      
      const name = document.getElementById('username').value.trim();
      if (!name) {
        alert("Please enter your name first!");
        return;
      }
      
      const ctx = resultCanvas.getContext('2d');
      resultCanvas.width = video.videoWidth;
      resultCanvas.height = video.videoHeight;
      
      // Draw video frame
      ctx.drawImage(video, 0, 0);
      
      // Convert name to hieroglyphs
      const hieroglyphs = name.toUpperCase().split('').map(c => hieroglyphMap[c] || '?').join('');
      
      // Add hieroglyphs to image
      ctx.font = 'bold 60px "Noto Sans Egyptian Hieroglyphs", sans-serif';
      ctx.fillStyle = 'rgba(255, 215, 0, 0.9)';
      ctx.strokeStyle = 'rgba(0, 0, 0, 0.8)';
      ctx.lineWidth = 3;
      ctx.textAlign = 'center';
      ctx.strokeText(hieroglyphs, resultCanvas.width/2, 80);
      ctx.fillText(hieroglyphs, resultCanvas.width/2, 80);
      
      // Show result
      resultCanvas.style.display = 'block';
      video.style.display = 'none';
      document.getElementById('actionButtons').style.display = 'none';
      document.getElementById('downloadSection').style.display = 'flex';
    });

    // Download Image
    document.getElementById('downloadBtn').addEventListener('click', () => {
      const link = document.createElement('a');
      link.download = 'pharaoh-photo.png';
      link.href = resultCanvas.toDataURL('image/png');
      link.click();
    });
  </script>
</body>
</html>
